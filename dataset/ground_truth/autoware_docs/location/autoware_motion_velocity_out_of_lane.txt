{
  "specifications": [
    {
      "section-id": 0,
      "sentence-id": 0,
      "sentence": "There are cases where the ego vehicle footprint goes out of the driving lane, for example when taking a narrow turn with a large vehicle.\n"
    },
    {
      "section-id": 0,
      "sentence-id": 1,
      "sentence": "The `out_of_lane` module adds deceleration and stop points to the ego trajectory in order to prevent collisions from occurring in these out of lane cases.\n"
    },
    {
      "section-id": 1,
      "sentence-id": 0,
      "sentence": "This module is activated if the launch parameter `launch_out_of_lane_module` is set to true.\n"
    },
    {
      "section-id": 2,
      "sentence-id": 0,
      "sentence": "This module calculates if out of lane collisions occur and insert stop point before the collisions if necessary.\n"
    },
    {
      "section-id": 3,
      "sentence-id": 0,
      "sentence": "In this first step, the ego footprint is projected at each trajectory point and its size is modified based on the `ego.extra_..._offset` parameters.\n"
    },
    {
      "section-id": 3,
      "sentence-id": 1,
      "sentence": "The length of the trajectory used for generating the footprints is limited by the `max_arc_length` parameter.\n"
    },
    {
      "section-id": 6,
      "sentence-id": 0,
      "sentence": "We filter objects and their predicted paths with the following conditions:\n"
    },
    {
      "section-id": 6,
      "sentence-id": 1,
      "sentence": "- ignore objects with a speed bellow the `minimum_velocity` parameter;\n"
    },
    {
      "section-id": 6,
      "sentence-id": 2,
      "sentence": "- ignore objects coming from behind the ego vehicle if parameter `ignore_behind_ego` is set to true;\n"
    },
    {
      "section-id": 6,
      "sentence-id": 3,
      "sentence": "- ignore predicted paths whose confidence value is bellow the `predicted_path_min_confidence` parameter;\n"
    },
    {
      "section-id": 6,
      "sentence-id": 4,
      "sentence": "- cut the points of predicted paths going beyond the stop line of a red traffic light if parameter `cut_predicted_paths_beyond_red_lights` is set to `true`.\n"
    },
    {
      "section-id": 7,
      "sentence-id": 1,
      "sentence": "In the case where parameter `mode` is set to `threshold` and the calculated time is less than `threshold.time_threshold` parameter, then we decide to avoid the out of lane area.\n"
    },
    {
      "section-id": 7,
      "sentence-id": 3,
      "sentence": "If the time to collision is bellow the `ttc.threshold` parameter value, we decide to avoid the out of lane area.\n"
    },
    {
      "section-id": 8,
      "sentence-id": 5,
      "sentence": "If still no valid pose is found, we use the base ego footprint without any offset.\n"
    },
    {
      "section-id": 8,
      "sentence-id": 6,
      "sentence": "In case no pose is found, we fallback to using the pose before the detected collision without caring if it is out of lane or not.\n"
    },
    {
      "section-id": 8,
      "sentence-id": 7,
      "sentence": "Whether it is decided to slow down or stop is determined by the distance between the ego vehicle and the trajectory point to avoid.\n"
    },
    {
      "section-id": 8,
      "sentence-id": 8,
      "sentence": "If this distance is bellow the `actions.slowdown.threshold`, a velocity of `actions.slowdown.velocity` will be used.\n"
    },
    {
      "section-id": 8,
      "sentence-id": 9,
      "sentence": "If the distance is bellow the `actions.stop.threshold`, a velocity of `0`m/s will be used.\n"
    },
    {
      "section-id": 9,
      "sentence-id": 1,
      "sentence": "To make the decision more stable, a stop or slowdown pose is used for a minimum duration set by the `action.min_duration` parameter.\n"
    },
    {
      "section-id": 9,
      "sentence-id": 2,
      "sentence": "If during that time a new pose closer to the ego vehicle is generated, then it replaces the previous one.\n"
    },
    {
      "section-id": 9,
      "sentence-id": 3,
      "sentence": "Otherwise, the stop or slowdown pose will only be discarded after no out of lane collision is detection for the set duration."
    }
  ]
}